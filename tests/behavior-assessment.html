<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Communication Style Assessment | å€‹äººæºé€šé¢¨æ ¼è©•ä¼°</title>
    <meta name="description" content="Professional assessment to identify your primary communication patterns and behavioral tendencies in interpersonal interactions.">

    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <link rel="stylesheet" href="../assets/css/change-assessment.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
    <div class="assessment-container">
        <!-- Navigation Header -->
        <nav class="nav-header">
            <a href="../index.html" class="logo">
                <span class="text-en">Explore Yourself</span>
                <span class="text-zh" style="display: none;">æ¢ç´¢è‡ªæˆ‘</span>
            </a>
            <div class="nav-meta">
                <div class="language-toggle">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="zh">ä¸­æ–‡</button>
                </div>
                <a href="../index.html" class="back-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-en">Back to Home</span>
                    <span class="text-zh" style="display: none;">å›åˆ°é¦–é </span>
                </a>
            </div>
        </nav>

        <!-- Assessment Header -->
        <header class="assessment-header">
            <div class="header-content">
                <div class="assessment-icon">ğŸ§ </div>
                <h1 class="assessment-title">
                    <span class="text-en">Your Authentic Communication Style</span>
                    <span class="text-zh" style="display: none;">æ‚¨çœŸå¯¦çš„æºé€šé¢¨æ ¼</span>
                </h1>
                <p class="assessment-subtitle">
                    <span class="text-en">Discover the beautiful way you connect with the world around you</span>
                    <span class="text-zh" style="display: none;">ç™¼ç¾æ‚¨èˆ‡å‘¨åœä¸–ç•Œé€£çµçš„ç¾å¥½æ–¹å¼</span>
                </p>
                
                <div class="assessment-info">
                    <div class="info-stat">
                        <span class="stat-number">60</span>
                        <span class="stat-label">
                            <span class="text-en">Questions</span>
                            <span class="text-zh" style="display: none;">é¡Œç›®</span>
                        </span>
                    </div>
                    <div class="info-stat">
                        <span class="stat-number">8-12</span>
                        <span class="stat-label">
                            <span class="text-en">Minutes</span>
                            <span class="text-zh" style="display: none;">åˆ†é˜</span>
                        </span>
                    </div>
                    <div class="info-stat">
                        <span class="stat-number">6</span>
                        <span class="stat-label">
                            <span class="text-en">Types</span>
                            <span class="text-zh" style="display: none;">é¡å‹</span>
                        </span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Instructions Panel -->
        <section class="instructions-panel">
            <div class="instructions-content">
                <h3 class="instructions-title">
                    <span class="text-en">ğŸŒ¸ Welcome to Your Journey</span>
                    <span class="text-zh" style="display: none;">ğŸŒ¸ æ­¡è¿ä¾†åˆ°æ‚¨çš„æ—…ç¨‹</span>
                </h3>
                
                <div class="instructions-text">
                    <div class="text-en">
                        <p>Welcome to a gentle exploration of who you are. Each question is an invitation to reflect on your natural way of being in the world. Trust what feels true for you - there's no right or wrong, only the beautiful uniqueness that is you.</p>
                    </div>
                    <div class="text-zh" style="display: none;">
                        <p>æ­¡è¿ä¾†åˆ°æº«å’Œçš„è‡ªæˆ‘æ¢ç´¢ã€‚æ¯å€‹å•é¡Œéƒ½æ˜¯é‚€è«‹æ‚¨åæ€åœ¨ä¸–ç•Œä¸­è‡ªç„¶å­˜åœ¨çš„æ–¹å¼ã€‚ç›¸ä¿¡å°æ‚¨ä¾†èªªæ„Ÿè¦ºçœŸå¯¦çš„æ±è¥¿â€”â€”æ²’æœ‰å°éŒ¯ï¼Œåªæœ‰å±¬æ–¼æ‚¨çš„ç¾éº—ç¨ç‰¹æ€§ã€‚</p>
                    </div>
                </div>
                
                <div class="scale-explanation">
                    <h4>
                        <span class="text-en">Rating Scale:</span>
                        <span class="text-zh" style="display: none;">è©•åˆ†æ¨™æº–ï¼š</span>
                    </h4>
                    <div class="scale-grid">
                        <div class="scale-item">
                            <div class="scale-number">1</div>
                            <div class="scale-text">
                                <span class="text-en">Never / Completely disagree</span>
                                <span class="text-zh" style="display: none;">å¾ä¸ / å®Œå…¨ä¸ç¬¦åˆ</span>
                            </div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number">2</div>
                            <div class="scale-text">
                                <span class="text-en">Rarely / Slightly agree</span>
                                <span class="text-zh" style="display: none;">å¾ˆå°‘ / è¼•å¾®ç¬¦åˆ</span>
                            </div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number">3</div>
                            <div class="scale-text">
                                <span class="text-en">Sometimes / Partially agree</span>
                                <span class="text-zh" style="display: none;">æœ‰æ™‚ / éƒ¨åˆ†ç¬¦åˆ</span>
                            </div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number">4</div>
                            <div class="scale-text">
                                <span class="text-en">Often / Mostly agree</span>
                                <span class="text-zh" style="display: none;">ç¶“å¸¸ / å¤§éƒ¨åˆ†ç¬¦åˆ</span>
                            </div>
                        </div>
                        <div class="scale-item">
                            <div class="scale-number">5</div>
                            <div class="scale-text">
                                <span class="text-en">Always / Completely agree</span>
                                <span class="text-zh" style="display: none;">ç¸½æ˜¯ / å®Œå…¨ç¬¦åˆ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="important-notes">
                    <div class="note-item">
                        <span class="note-icon">ğŸ’¡</span>
                        <span class="text-en">Trust your first instinct - it's usually the most authentic</span>
                        <span class="text-zh" style="display: none;">ç›¸ä¿¡æ‚¨çš„ç¬¬ä¸€ç›´è¦ºï¼Œé€šå¸¸æ˜¯æœ€çœŸå¯¦çš„</span>
                    </div>
                    <div class="note-item">
                        <span class="note-icon">ğŸŒˆ</span>
                        <span class="text-en">Every answer is valid - this is about discovering your unique style</span>
                        <span class="text-zh" style="display: none;">æ¯å€‹ç­”æ¡ˆéƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œé€™æ˜¯ç‚ºäº†ç™¼ç¾æ‚¨ç¨ç‰¹çš„é¢¨æ ¼</span>
                    </div>
                    <div class="note-item">
                        <span class="note-icon">ğŸ</span>
                        <span class="text-en">Your personalized insights will be delivered to your email</span>
                        <span class="text-zh" style="display: none;">æ‚¨çš„å€‹äººåŒ–æ´å¯Ÿå°‡ç™¼é€åˆ°æ‚¨çš„é›»å­éƒµä»¶</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Assessment Form -->
        <main class="assessment-main">
            <form id="assessmentForm" class="assessment-form">
                <!-- Name Input Section -->
                <div class="name-input-section">
                    <div class="input-group">
                        <label for="studentName" class="input-label">
                            <span class="label-icon">ğŸ‘¤</span>
                            <span class="text-en">Your Full Name</span>
                            <span class="text-zh" style="display: none;">æ‚¨çš„çœŸå¯¦å§“å</span>
                            <span class="required-mark">*</span>
                        </label>
                        <input type="text" id="studentName" name="studentName" required 
                               class="name-input"
                               placeholder="Enter your full name / è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å">
                    </div>
                    
                    <div class="input-group">
                        <label for="studentEmail" class="input-label">
                            <span class="label-icon">ğŸ“§</span>
                            <span class="text-en">Your Email Address</span>
                            <span class="text-zh" style="display: none;">æ‚¨çš„é›»å­éƒµä»¶åœ°å€</span>
                            <span class="required-mark">*</span>
                        </label>
                        <input type="email" id="studentEmail" name="studentEmail" required 
                               class="name-input"
                               placeholder="Enter your email / è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶">
                    </div>
                </div>



                <!-- Questions Container -->
                <div id="questionsContainer" class="questions-container">
                    <!-- Questions will be populated by JavaScript -->
                </div>

                <!-- Submit Section -->
                <div class="submit-section">
                    <button type="submit" id="submitBtn" class="submit-button" disabled>
                        <span class="button-content">
                            <span class="button-icon">âœ¨</span>
                            <span class="button-text">
                                <span class="text-en">Reveal My Authentic Self</span>
                                <span class="text-zh" style="display: none;">æ­ç¤ºçœŸå¯¦çš„è‡ªæˆ‘</span>
                            </span>
                        </span>
                        <div class="button-shine"></div>
                    </button>
                    
                    <p class="submit-note">
                        <span class="text-en">Your personalized insights will arrive in your inbox moments after completion</span>
                        <span class="text-zh" style="display: none;">æ‚¨çš„å€‹äººåŒ–æ´å¯Ÿå°‡åœ¨å®Œæˆå¾Œç«‹å³ç™¼é€åˆ°æ‚¨çš„æ”¶ä»¶ç®±</span>
                    </p>
                </div>
            </form>
        </main>

        <!-- Fixed Scale Reference -->
        <div class="scale-reference" id="scaleReference">
            <div class="scale-content">
                <div class="scale-title">
                    <span class="text-en">Quick Reference</span>
                    <span class="text-zh" style="display: none;">å¿«é€Ÿåƒè€ƒ</span>
                </div>
                <div class="scale-items">
                    <span class="scale-quick-item">1 = <span class="text-en">Never</span><span class="text-zh" style="display: none;">å¾ä¸</span></span>
                    <span class="scale-quick-item">3 = <span class="text-en">Sometimes</span><span class="text-zh" style="display: none;">æœ‰æ™‚</span></span>
                    <span class="scale-quick-item">5 = <span class="text-en">Always</span><span class="text-zh" style="display: none;">ç¸½æ˜¯</span></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize EmailJS
        emailjs.init("I2KqoGsE81K29GmFC");

        // Language Toggle Functionality with inheritance from homepage
        function initializeLanguageToggle() {
            // Get language preference from sessionStorage (set by language selection)
            const savedLang = sessionStorage.getItem('selectedLanguage') || 'en';
            
            const langButtons = document.querySelectorAll('.lang-btn');
            const enElements = document.querySelectorAll('.text-en');
            const zhElements = document.querySelectorAll('.text-zh');
            
            // Apply saved language immediately
            if (savedLang === 'zh') {
                langButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.lang === 'zh'));
                enElements.forEach(el => el.style.display = 'none');
                zhElements.forEach(el => el.style.display = '');
                document.documentElement.lang = 'zh-TW';
                updatePlaceholders('zh');
            } else {
                langButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.lang === 'en'));
                enElements.forEach(el => el.style.display = '');
                zhElements.forEach(el => el.style.display = 'none');
                document.documentElement.lang = 'en';
                updatePlaceholders('en');
            }
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.dataset.lang;
                    
                    // Update button states
                    langButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Save language preference for current session
                    sessionStorage.setItem('selectedLanguage', lang);
                    
                    // Toggle language visibility
                    if (lang === 'en') {
                        enElements.forEach(el => el.style.display = '');
                        zhElements.forEach(el => el.style.display = 'none');
                        document.documentElement.lang = 'en';
                        updatePlaceholders('en');
                    } else {
                        enElements.forEach(el => el.style.display = 'none');
                        zhElements.forEach(el => el.style.display = '');
                        document.documentElement.lang = 'zh-TW';
                        updatePlaceholders('zh');
                    }
                    
                    // Regenerate questions in the new language
                    generateQuestions();
                });
            });
        }

        function updatePlaceholders(lang) {
            const nameInput = document.getElementById('studentName');
            const emailInput = document.getElementById('studentEmail');
            if (lang === 'en') {
                nameInput.placeholder = 'Enter your full name';
                emailInput.placeholder = 'Enter your email address';
            } else {
                nameInput.placeholder = 'è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å';
                emailInput.placeholder = 'è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶';
            }
        }

        // High-Quality Behavior Assessment Questions with Traditional Chinese Translations
        const questions = {
            en: [
                "I often worry about what others think of me.",
                "I frequently second-guess my decisions.",
                "I tend to avoid confrontation even when it's necessary.",
                "I often feel the need to prove myself to others.",
                "I have difficulty saying 'no' to requests.",
                "I worry excessively about making mistakes.",
                "I often feel responsible for other people's emotions.",
                "I tend to procrastinate on important tasks.",
                "I frequently compare myself to others.",
                "I often feel like I'm not good enough.",
                "I have trouble accepting compliments.",
                "I tend to catastrophize situations.",
                "I often feel overwhelmed by daily responsibilities.",
                "I have difficulty expressing my true feelings.",
                "I tend to put others' needs before my own.",
                "I often feel guilty when I take time for myself.",
                "I have trouble trusting my own judgment.",
                "I frequently feel anxious in social situations.",
                "I tend to avoid taking risks.",
                "I often feel like I need to be perfect.",
                "I have difficulty setting boundaries with others.",
                "I tend to overthink situations.",
                "I often feel like I'm disappointing others.",
                "I have trouble asking for help when I need it.",
                "I frequently feel stressed about things I cannot control.",
                "I tend to be overly critical of myself.",
                "I often feel like I'm not living up to my potential.",
                "I have difficulty making decisions without seeking approval.",
                "I tend to avoid difficult conversations.",
                "I often feel responsible for fixing other people's problems.",
                "I have trouble enjoying success because I worry about the future.",
                "I frequently feel like I'm pretending to be someone I'm not.",
                "I tend to minimize my own achievements.",
                "I often feel anxious when I'm not busy or productive.",
                "I have difficulty relaxing and enjoying the present moment.",
                "I tend to focus more on my failures than my successes.",
                "I often feel like I need external validation to feel worthy.",
                "I have trouble believing that I deserve good things.",
                "I frequently feel like I'm behind in life compared to others.",
                "I tend to sacrifice my own happiness for others.",
                "I often feel like I'm walking on eggshells around certain people.",
                "I have difficulty expressing anger or frustration appropriately.",
                "I tend to ruminate on past mistakes or embarrassing moments.",
                "I often feel like I need to justify my choices to others.",
                "I have trouble being vulnerable or opening up to others.",
                "I frequently feel like I'm not smart or capable enough.",
                "I tend to avoid situations where I might be judged.",
                "I often feel like I'm carrying the weight of the world.",
                "I have difficulty celebrating my accomplishments.",
                "I tend to expect the worst-case scenario in most situations.",
                "I often feel like I'm not deserving of love or respect.",
                "I have trouble maintaining my energy and motivation over time.",
                "I frequently feel like I need to hide my true self from others.",
                "I tend to feel guilty about past decisions or actions.",
                "I often feel like I'm not meeting others' expectations.",
                "I have difficulty trusting that things will work out okay.",
                "I tend to focus on what's wrong rather than what's right.",
                "I often feel like I'm not in control of my own life.",
                "I have trouble accepting that I can't please everyone.",
                "I frequently feel overwhelmed by the expectations I place on myself."
            ],
            zh: [
                "æˆ‘ç¶“å¸¸æ“”å¿ƒåˆ¥äººå°æˆ‘çš„çœ‹æ³•ã€‚",
                "æˆ‘ç¶“å¸¸å°è‡ªå·±çš„æ±ºå®šæ„Ÿåˆ°æ‡·ç–‘ã€‚",
                "å³ä½¿åœ¨å¿…è¦æ™‚ï¼Œæˆ‘ä¹Ÿå‚¾å‘æ–¼é¿å…è¡çªã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—éœ€è¦å‘åˆ¥äººè­‰æ˜è‡ªå·±ã€‚",
                "æˆ‘å¾ˆé›£å°åˆ¥äººçš„è¦æ±‚èªªã€Œä¸ã€ã€‚",
                "æˆ‘éåº¦æ“”å¿ƒçŠ¯éŒ¯èª¤ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±è¦ç‚ºåˆ¥äººçš„æƒ…ç·’è² è²¬ã€‚",
                "æˆ‘å‚¾å‘æ–¼æ‹–å»¶é‡è¦çš„ä»»å‹™ã€‚",
                "æˆ‘ç¶“å¸¸æ‹¿è‡ªå·±å’Œåˆ¥äººæ¯”è¼ƒã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±ä¸å¤ å¥½ã€‚",
                "æˆ‘å¾ˆé›£æ¥å—è®šç¾ã€‚",
                "æˆ‘å‚¾å‘æ–¼æŠŠæƒ…æ³æƒ³å¾—å¾ˆåš´é‡ã€‚",
                "æˆ‘ç¶“å¸¸å› æ—¥å¸¸è²¬ä»»æ„Ÿåˆ°ä¸çŸ¥æ‰€æªã€‚",
                "æˆ‘å¾ˆé›£è¡¨é”è‡ªå·±çš„çœŸå¯¦æ„Ÿå—ã€‚",
                "æˆ‘å‚¾å‘æ–¼æŠŠåˆ¥äººçš„éœ€è¦æ”¾åœ¨è‡ªå·±ä¹‹å‰ã€‚",
                "ç•¶æˆ‘ç‚ºè‡ªå·±å®‰æ’æ™‚é–“æ™‚ï¼Œæˆ‘ç¶“å¸¸æ„Ÿåˆ°å…§ç–šã€‚",
                "æˆ‘å¾ˆé›£ç›¸ä¿¡è‡ªå·±çš„åˆ¤æ–·ã€‚",
                "æˆ‘åœ¨ç¤¾äº¤å ´åˆç¶“å¸¸æ„Ÿåˆ°ç„¦æ…®ã€‚",
                "æˆ‘å‚¾å‘æ–¼é¿å…å†’éšªã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±éœ€è¦å®Œç¾ã€‚",
                "æˆ‘å¾ˆé›£èˆ‡åˆ¥äººè¨­å®šç•Œé™ã€‚",
                "æˆ‘å‚¾å‘æ–¼éåº¦æ€è€ƒæƒ…æ³ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±è®“åˆ¥äººå¤±æœ›äº†ã€‚",
                "ç•¶æˆ‘éœ€è¦å¹«åŠ©æ™‚ï¼Œæˆ‘å¾ˆé›£é–‹å£æ±‚åŠ©ã€‚",
                "æˆ‘ç¶“å¸¸ç‚ºç„¡æ³•æ§åˆ¶çš„äº‹æƒ…æ„Ÿåˆ°å£“åŠ›ã€‚",
                "æˆ‘å‚¾å‘æ–¼éåº¦æ‰¹è©•è‡ªå·±ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±æ²’æœ‰ç™¼æ®æ½›åŠ›ã€‚",
                "æˆ‘å¾ˆé›£åœ¨ä¸å°‹æ±‚èªåŒçš„æƒ…æ³ä¸‹åšæ±ºå®šã€‚",
                "æˆ‘å‚¾å‘æ–¼é¿å…å›°é›£çš„å°è©±ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±æœ‰è²¬ä»»è§£æ±ºåˆ¥äººçš„å•é¡Œã€‚",
                "æˆ‘å¾ˆé›£äº«å—æˆåŠŸï¼Œå› ç‚ºæˆ‘æ“”å¿ƒæœªä¾†ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±åœ¨å‡è£æˆåˆ¥äººã€‚",
                "æˆ‘å‚¾å‘æ–¼è²¶ä½è‡ªå·±çš„æˆå°±ã€‚",
                "ç•¶æˆ‘ä¸å¿™ç¢Œæˆ–ä¸å…·ç”Ÿç”¢åŠ›æ™‚ï¼Œæˆ‘ç¶“å¸¸æ„Ÿåˆ°ç„¦æ…®ã€‚",
                "æˆ‘å¾ˆé›£æ”¾é¬†å’Œäº«å—ç•¶ä¸‹ã€‚",
                "æˆ‘å‚¾å‘æ–¼æ›´é—œæ³¨å¤±æ•—è€Œä¸æ˜¯æˆåŠŸã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—éœ€è¦å¤–åœ¨èªåŒæ‰èƒ½æ„Ÿåˆ°æœ‰åƒ¹å€¼ã€‚",
                "æˆ‘å¾ˆé›£ç›¸ä¿¡è‡ªå·±å€¼å¾—æ“æœ‰å¥½æ±è¥¿ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—èˆ‡åˆ¥äººç›¸æ¯”ï¼Œè‡ªå·±åœ¨ç”Ÿæ´»ä¸­è½å¾Œäº†ã€‚",
                "æˆ‘å‚¾å‘æ–¼ç‚ºäº†åˆ¥äººè€ŒçŠ§ç‰²è‡ªå·±çš„å¿«æ¨‚ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±åœ¨æŸäº›äººé¢å‰å¦‚å±¥è–„å†°ã€‚",
                "æˆ‘å¾ˆé›£é©ç•¶åœ°è¡¨é”æ†¤æ€’æˆ–æŒ«æŠ˜ã€‚",
                "æˆ‘å‚¾å‘æ–¼åè¦†æ€è€ƒéå»çš„éŒ¯èª¤æˆ–å°·å°¬æ™‚åˆ»ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—éœ€è¦å‘åˆ¥äººç‚ºè‡ªå·±çš„é¸æ“‡è¾¯è­·ã€‚",
                "æˆ‘å¾ˆé›£åœ¨åˆ¥äººé¢å‰è¡¨ç¾è„†å¼±æˆ–æ•é–‹å¿ƒæ‰‰ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±ä¸å¤ è°æ˜æˆ–ä¸å¤ èƒ½å¹¹ã€‚",
                "æˆ‘å‚¾å‘æ–¼é¿å…å¯èƒ½è¢«è©•åˆ¤çš„æƒ…æ³ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±æ‰¿æ“”è‘—æ•´å€‹ä¸–ç•Œçš„é‡é‡ã€‚",
                "æˆ‘å¾ˆé›£æ…¶ç¥è‡ªå·±çš„æˆå°±ã€‚",
                "æˆ‘å‚¾å‘æ–¼åœ¨å¤§å¤šæ•¸æƒ…æ³ä¸‹æœŸå¾…æœ€å£çš„çµæœã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±ä¸é…å¾—åˆ°æ„›æˆ–å°Šé‡ã€‚",
                "æˆ‘å¾ˆé›£é•·æœŸä¿æŒç²¾åŠ›å’Œå‹•åŠ›ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—éœ€è¦å‘åˆ¥äººéš±è—çœŸå¯¦çš„è‡ªå·±ã€‚",
                "æˆ‘å‚¾å‘æ–¼ç‚ºéå»çš„æ±ºå®šæˆ–è¡Œç‚ºæ„Ÿåˆ°å…§ç–šã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±æ²’æœ‰é”åˆ°åˆ¥äººçš„æœŸæœ›ã€‚",
                "æˆ‘å¾ˆé›£ç›¸ä¿¡äº‹æƒ…æœƒå¥½è½‰ã€‚",
                "æˆ‘å‚¾å‘æ–¼é—œæ³¨éŒ¯èª¤çš„åœ°æ–¹è€Œä¸æ˜¯æ­£ç¢ºçš„åœ°æ–¹ã€‚",
                "æˆ‘ç¶“å¸¸è¦ºå¾—è‡ªå·±ç„¡æ³•æ§åˆ¶è‡ªå·±çš„ç”Ÿæ´»ã€‚",
                "æˆ‘å¾ˆé›£æ¥å—è‡ªå·±ç„¡æ³•å–æ‚…æ‰€æœ‰äººã€‚",
                "æˆ‘ç¶“å¸¸å› ç‚ºå°è‡ªå·±çš„æœŸæœ›è€Œæ„Ÿåˆ°ä¸çŸ¥æ‰€æªã€‚"
            ]
        };

        // Progress Tracking
        let currentProgress = 0;
        const totalQuestions = 60;

        function updateProgress() {
            const progressNumber = document.getElementById('progressNumber');
            const progressRing = document.getElementById('progressRing');
            
            const percentage = Math.round((currentProgress / totalQuestions) * 100);
            
            // Update text
            progressNumber.textContent = currentProgress;
            
            // Update circular progress bar
            const circumference = 2 * Math.PI * 25; // radius is 25
            const offset = circumference - (percentage / 100) * circumference;
            progressRing.style.strokeDasharray = circumference;
            progressRing.style.strokeDashoffset = offset;
        }

        // Generate Questions
        function generateQuestions() {
            const container = document.getElementById('questionsContainer');
            const currentLang = document.querySelector('.lang-btn.active').dataset.lang;
            const questionSet = questions[currentLang];
            
            container.innerHTML = '';
            
            questionSet.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-item';
                questionDiv.innerHTML = `
                    <div class="question-header">
                        <span class="question-number">${index + 1}</span>
                        <p class="question-text">${question}</p>
                    </div>
                    <div class="rating-options">
                        ${[1, 2, 3, 4, 5].map(value => `
                            <label class="rating-option">
                                <input type="radio" name="q${index}" value="${value}" required>
                                <span class="rating-circle">
                                    <span class="rating-number">${value}</span>
                                </span>
                            </label>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });

            // Add event listeners for progress tracking
            const radioButtons = container.querySelectorAll('input[type="radio"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', () => {
                    updateProgressFromAnswers();
                });
            });
        }

        function updateProgressFromAnswers() {
            const answeredQuestions = new Set();
            const radioButtons = document.querySelectorAll('#questionsContainer input[type="radio"]:checked');
            
            radioButtons.forEach(radio => {
                answeredQuestions.add(radio.name);
            });
            
            currentProgress = answeredQuestions.size;
            updateProgress();
            
            // Enable submit button when all questions are answered
            const submitBtn = document.getElementById('submitBtn');
            const studentName = document.getElementById('studentName').value.trim();
            const studentEmail = document.getElementById('studentEmail').value.trim();
            
            if (currentProgress === totalQuestions && studentName && studentEmail) {
                submitBtn.disabled = false;
                submitBtn.classList.add('ready');
            } else {
                submitBtn.disabled = true;
                submitBtn.classList.remove('ready');
            }
        }

        // Form Submission
        document.getElementById('assessmentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const studentName = document.getElementById('studentName').value.trim();
            const studentEmail = document.getElementById('studentEmail').value.trim();
            const currentLang = document.querySelector('.lang-btn.active').dataset.lang;
            
            // Validate inputs
            if (!studentName) {
                alert(currentLang === 'en' ? 'Please enter your name.' : 'è«‹è¼¸å…¥æ‚¨çš„å§“åã€‚');
                return;
            }
            
            if (!studentEmail) {
                alert(currentLang === 'en' ? 'Please enter your email address.' : 'è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶åœ°å€ã€‚');
                return;
            }
            
            // Collect answers
            const answers = [];
            for (let i = 0; i < totalQuestions; i++) {
                const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                if (selectedOption) {
                    answers.push(parseInt(selectedOption.value));
                }
            }
            
            // Calculate behavioral pattern scores
            const typeScores = [0, 0, 0, 0, 0, 0]; // 6 personality types
            
            // Distribute questions among 6 types (10 questions each)
            for (let i = 0; i < totalQuestions; i++) {
                const typeIndex = Math.floor(i / 10);
                typeScores[typeIndex] += answers[i];
            }
            
            // Calculate percentages
            const typePercentages = typeScores.map(score => Math.round((score / 50) * 100));
            const totalScore = answers.reduce((sum, answer) => sum + answer, 0);
            
            // Determine dominant type
            const maxScore = Math.max(...typePercentages);
            const dominantTypeIndex = typePercentages.indexOf(maxScore);
            
            const typeNames = {
                en: ['Pleaser', 'Worrier', 'Prover', 'Critic', 'Avoider', 'Martyr'],
                zh: ['å–æ‚…è€…', 'æ“”æ†‚è€…', 'è­‰æ˜è€…', 'æ‰¹è©•è€…', 'è¿´é¿è€…', 'æ®‰é“è€…']
            };
            
            const resultCategory = typeNames[currentLang][dominantTypeIndex];
            const resultDescription = currentLang === 'en' ? 
                `Your dominant behavioral pattern is ${resultCategory} with ${maxScore}% tendency. This indicates your primary psychological approach to challenges and relationships.` :
                `æ‚¨çš„ä¸»è¦è¡Œç‚ºæ¨¡å¼æ˜¯${resultCategory}ï¼Œå‚¾å‘åº¦ç‚º${maxScore}%ã€‚é€™é¡¯ç¤ºäº†æ‚¨é¢å°æŒ‘æˆ°å’Œäººéš›é—œä¿‚çš„ä¸»è¦å¿ƒç†æ–¹å¼ã€‚`;
            
            // Prepare email content
            const emailContent = `
                Student Name: ${studentName}
                Assessment: Personality Behavior Pattern Assessment
                Completion Date: ${new Date().toLocaleString()}
                
                Results Summary:
                Total Score: ${totalScore}/${totalQuestions * 5}
                Dominant Type: ${resultCategory} (${maxScore}%)
                
                Type Breakdown:
                ${typeNames.en.map((name, index) => `${name}: ${typePercentages[index]}%`).join('\n')}
                
                Description: ${resultDescription}
                
                Individual Question Responses:
                ${answers.map((answer, index) => `Question ${index + 1}: ${answer}/5`).join('\n')}
            `;
            
            try {
                // Store results and redirect (skip email for now)
                sessionStorage.setItem('assessmentResults', JSON.stringify({
                    studentName,
                    testType: 'Personality Behavior Pattern Assessment',
                    totalScore,
                    resultCategory,
                    resultDescription,
                    typePercentages,
                    answers,
                    completionDate: new Date().toLocaleString()
                }));
                
                // Try to send email but don't block on failure
                try {
                    // Create type breakdown for personality assessment
                    const typeNames = currentLang === 'en' ? 
                        ['Pleaser', 'Worrier', 'Prover', 'Critic', 'Avoider', 'Martyr'] :
                        ['å–æ‚…è€…', 'æ“”æ†‚è€…', 'è­‰æ˜è€…', 'æ‰¹è©•è€…', 'è¿´é¿è€…', 'æ®‰é“è€…'];
                    
                    const breakdownHtml = `
                        <div style="background-color: white; border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <h5 style="margin: 0 0 12px 0; color: #667eea; font-size: 14px;">${currentLang === 'en' ? 'Personality Type Breakdown:' : 'äººæ ¼é¡å‹åˆ†æï¼š'}</h5>
                            ${typePercentages.map((percentage, index) => {
                                const isTop = percentage === maxScore;
                                return `<div style="display: flex; justify-content: space-between; margin-bottom: 8px; padding: 6px 12px; background-color: ${isTop ? '#f0f4ff' : '#f8f9fa'}; border-radius: 4px; ${isTop ? 'border-left: 3px solid #667eea;' : ''}">
                                    <span style="font-size: 13px; color: #555;">${typeNames[index]}${isTop ? ' â­' : ''}</span>
                                    <span style="font-weight: ${isTop ? 'bold' : 'normal'}; color: ${isTop ? '#667eea' : '#666'}; font-size: 13px;">${percentage}%</span>
                                </div>`;
                            }).join('')}
                        </div>
                    `;
                    
                    // Prepare multilingual email content
                    const emailData = {
                        student_name: studentName,
                        student_email: studentEmail || document.getElementById('studentEmail').value,
                        test_type: currentLang === 'en' ? "Personality Behavior Pattern Assessment" : "äººæ ¼è¡Œç‚ºæ¨¡å¼è©•ä¼°",
                        completion_date: new Date().toLocaleDateString(),
                        message: emailContent,
                        
                        // Header content
                        header_emoji: "ğŸ§ ",
                        header_title: currentLang === 'en' ? "Personality Results" : "äººæ ¼è©•ä¼°çµæœ",
                        
                        // Greeting and messages
                        greeting: currentLang === 'en' ? "Hello" : "æ‚¨å¥½",
                        completion_message: currentLang === 'en' ? 
                            "Thank you for completing the Personality Behavior Pattern Assessment! Your detailed personality analysis is ready." :
                            "æ„Ÿè¬æ‚¨å®Œæˆäººæ ¼è¡Œç‚ºæ¨¡å¼è©•ä¼°ï¼æ‚¨çš„è©³ç´°äººæ ¼åˆ†æå·²æº–å‚™å¥½ã€‚",
                            
                        // Results section
                        results_title: currentLang === 'en' ? "Your Personality Profile" : "æ‚¨çš„äººæ ¼æª”æ¡ˆ",
                        main_score: `${maxScore}%`,
                        score_label: currentLang === 'en' ? "Dominant Pattern Strength" : "ä¸»è¦æ¨¡å¼å¼·åº¦",
                        result_category: resultCategory,
                        result_description: resultDescription,
                        breakdown_section: breakdownHtml,
                        
                        // Insights
                        insights_title: currentLang === 'en' ? "Understanding Your Results" : "ç†è§£æ‚¨çš„çµæœ",
                        insights_text: currentLang === 'en' ? 
                            "Your personality profile reveals patterns in how you think, feel, and behave. Use these insights to understand your natural tendencies and identify opportunities for personal growth." :
                            "æ‚¨çš„äººæ ¼æª”æ¡ˆæ­ç¤ºäº†æ‚¨æ€è€ƒã€æ„Ÿå—å’Œè¡Œç‚ºçš„æ¨¡å¼ã€‚è«‹åˆ©ç”¨é€™äº›æ´å¯Ÿä¾†äº†è§£æ‚¨çš„è‡ªç„¶å‚¾å‘ä¸¦è­˜åˆ¥å€‹äººæˆé•·çš„æ©Ÿæœƒã€‚",
                            
                        // Footer content
                        detailed_title: currentLang === 'en' ? "Complete Assessment Data" : "å®Œæ•´è©•ä¼°æ•¸æ“š",
                        completion_date_label: currentLang === 'en' ? "Assessment completed on:" : "è©•ä¼°å®Œæˆæ—¥æœŸï¼š",
                        questions_text: currentLang === 'en' ? "Questions about your results?" : "å°çµæœæœ‰ç–‘å•ï¼Ÿ",
                        disclaimer_text: currentLang === 'en' ? 
                            "This personality assessment is designed for educational and self-development purposes. Results should be used as a guide for personal reflection and growth." :
                            "æ­¤äººæ ¼è©•ä¼°ç”¨æ–¼æ•™è‚²å’Œè‡ªæˆ‘ç™¼å±•ç›®çš„ã€‚çµæœæ‡‰ä½œç‚ºå€‹äººåæ€å’Œæˆé•·çš„æŒ‡å—ã€‚",
                        footer_brand: currentLang === 'en' ? "Personality Assessment Team" : "äººæ ¼è©•ä¼°æ¸¬è©¦åœ˜éšŠ",
                        footer_subtitle: currentLang === 'en' ? "Professional Psychological Evaluation" : "å°ˆæ¥­å¿ƒç†è©•ä¼°"
                    };
                    
                    // Send to user
                    await emailjs.send("service_2mndbrx", "template_z0l98oa", emailData);
                    
                    // Send to admin (always in English for admin)
                    const adminEmailData = { ...emailData };
                    adminEmailData.student_email = "felicco@gmail.com";
                    adminEmailData.test_type = "Personality Behavior Pattern Assessment";
                    adminEmailData.header_title = "Personality Results";
                    adminEmailData.greeting = "Hello";
                    adminEmailData.completion_message = `${studentName} has completed the Personality Behavior Pattern Assessment. Results summary attached.`;
                    
                    await emailjs.send("service_2mndbrx", "template_z0l98oa", adminEmailData);
                    
                    console.log('Emails sent successfully');
                } catch (emailError) {
                    console.log('Email failed but continuing to results:', emailError);
                }
                
                window.location.href = 'results.html';
                
            } catch (error) {
                console.error('Error processing assessment:', error);
                alert(currentLang === 'en' ? 
                    'There was an error processing your results. Please try again.' :
                    'è™•ç†æ‚¨çš„çµæœæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹é‡è©¦ã€‚');
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeLanguageToggle();
            generateQuestions();
            updateProgress();
            
            // Add input listeners for real-time validation
            document.getElementById('studentName').addEventListener('input', updateProgressFromAnswers);
            document.getElementById('studentEmail').addEventListener('input', updateProgressFromAnswers);
        });
    </script>

    <!-- Floating Progress Indicator - positioned above scale reference -->
    <div id="progressIndicator" class="floating-progress floating-progress-stacked">
        <div class="progress-circle">
            <svg class="progress-ring" width="60" height="60">
                <circle class="progress-ring-background" cx="30" cy="30" r="25"></circle>
                <circle class="progress-ring-progress" cx="30" cy="30" r="25" id="progressRing"></circle>
            </svg>
            <div class="progress-text">
                <span id="progressNumber">0</span>
                <span class="progress-total">/60</span>
            </div>
        </div>
        <div class="progress-label-text">
            <span class="text-en">Progress</span>
            <span class="text-zh" style="display: none;">é€²åº¦</span>
        </div>
    </div>
</body>
</html> 