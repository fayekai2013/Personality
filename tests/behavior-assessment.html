<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Communication Style Assessment | å€‹äººæºé€šé¢¨æ ¼è©•ä¼°</title>
    <meta name="description" content="Professional assessment to identify your primary communication patterns and behavioral tendencies in interpersonal interactions.">

    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <link rel="stylesheet" href="../assets/css/behavior-assessment.css?v=2">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
    <div class="assessment-container">
        <!-- Navigation Header -->
        <nav class="nav-header">
            <a href="../index.html" class="logo">
                <span class="text-en">Explore Yourself</span>
                <span class="text-zh" style="display: none;">æ¢ç´¢è‡ªæˆ‘</span>
            </a>
            <div class="nav-meta">
                <div class="language-toggle">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="zh"TW</button>
                </div>
                <a href="../index.html" class="back-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-en">Back to Home</span>
                    <span class="text-zh" style="display: none;">å›åˆ°é¦–é </span>
                </a>
            </div>
        </nav>

        <!-- Assessment Header -->
        <header class="assessment-header">
            <div class="header-content">
                <div class="assessment-icon">ğŸ§ </div>
                <h1 class="assessment-title">
                    <span class="text-en">Your Authentic Communication Style</span>
                    <span class="text-zh" style="display: none;">æ‚¨çœŸå¯¦çš„æºé€šé¢¨æ ¼</span>
                </h1>
                <p class="assessment-subtitle">
                    <span class="text-en">Discover how you naturally communicate and process information. Through 60 questions, you'll uncover your authentic communication styleâ€”how you absorb information, make decisions, and connect with others.</span>
                    <span class="text-zh" style="display: none;">ç™¼ç¾ä½ è‡ªç„¶çš„æºé€šå’Œè³‡è¨Šè™•ç†æ–¹å¼ã€‚é€é 60 é“é¡Œç›®ï¼Œæ­ç¤ºä½ çœŸå¯¦çš„æºé€šé¢¨æ ¼â€”â€”ä½ å¦‚ä½•å¸æ”¶è³‡è¨Šã€åšæ±ºå®šã€èˆ‡ä»–äººé€£çµã€‚</span>
                </p>
                
                <div class="assessment-info">
                    <div class="info-stat">
                        <span class="stat-number">60</span>
                        <span class="stat-label">
                            <span class="text-en">Questions</span>
                            <span class="text-zh" style="display: none;">é¡Œç›®</span>
                        </span>
                    </div>
                    <div class="info-stat">
                        <span class="stat-number">8-12</span>
                        <span class="stat-label">
                            <span class="text-en">Minutes</span>
                            <span class="text-zh" style="display: none;">åˆ†é˜</span>
                        </span>
                    </div>
                    <div class="info-stat">
                        <span class="stat-number">6</span>
                        <span class="stat-label">
                            <span class="text-en">Types</span>
                            <span class="text-zh" style="display: none;">é¡å‹</span>
                        </span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Instructions Panel -->
        <section class="instructions-panel">
            <div class="instructions-content">
                <h3 class="instructions-title">
                    <span class="text-en">Assessment Instructions</span>
                    <span class="text-zh" style="display: none;">è©•ä¼°èªªæ˜</span>
                </h3>
                
                <div class="instructions-text">
                    <div class="text-en">
                        <p>This assessment identifies behavioral patterns that emerge when you're <strong>not at your best</strong> (stressed, upset, tired, etc.). Answer each question thinking about how you behave during challenging times, not your normal functioning. There are no right or wrong answersâ€”respond honestly to get accurate results.</p>
                    </div>
                    <div class="text-zh" style="display: none;">
                        <p>æ­¤è©•ä¼°è­˜åˆ¥ç•¶æ‚¨<strong>ä¸åœ¨æœ€ä½³ç‹€æ…‹æ™‚</strong>ï¼ˆæ¯”å¦‚å£“åŠ›å¤§ã€å¿ƒæƒ…ä¸å¥½ã€ç–²æ†Šä¸å ªç­‰ï¼‰å‡ºç¾çš„è¡Œç‚ºæ¨¡å¼ã€‚è«‹æ ¹æ“šæ‚¨åœ¨å›°é›£æ™‚æœŸçš„è¡Œç‚ºæ–¹å¼å›ç­”æ¯å€‹å•é¡Œï¼Œè€Œä¸æ˜¯æ­£å¸¸ç‹€æ…‹ä¸‹çš„è¡¨ç¾ã€‚æ²’æœ‰å°éŒ¯ç­”æ¡ˆâ€”â€”èª å¯¦å›ç­”ä»¥ç²å¾—æº–ç¢ºçµæœã€‚</p>
                    </div>
                </div>
                


                <div class="important-notes">
                    <div class="note-item">
                        <span class="note-icon">ğŸ’¡</span>
                        <span class="text-en">Trust your first instinct - it's usually the most authentic</span>
                        <span class="text-zh" style="display: none;">ç›¸ä¿¡æ‚¨çš„ç¬¬ä¸€ç›´è¦ºï¼Œé€šå¸¸æ˜¯æœ€çœŸå¯¦çš„</span>
                    </div>
                    <div class="note-item">
                        <span class="note-icon">ğŸŒˆ</span>
                        <span class="text-en">Every answer is valid - this is about discovering your unique style</span>
                        <span class="text-zh" style="display: none;">æ¯å€‹ç­”æ¡ˆéƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œé€™æ˜¯ç‚ºäº†ç™¼ç¾æ‚¨ç¨ç‰¹çš„é¢¨æ ¼</span>
                    </div>
                    <div class="note-item">
                        <span class="note-icon">ğŸ</span>
                        <span class="text-en">Your personalized insights will be delivered to your email</span>
                        <span class="text-zh" style="display: none;">æ‚¨çš„å€‹äººåŒ–æ´å¯Ÿå°‡ç™¼é€åˆ°æ‚¨çš„é›»å­éƒµä»¶</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Assessment Form -->
        <main class="assessment-main">
            <form id="assessmentForm" class="assessment-form">
                <!-- Name Input Section -->
                <div class="name-input-section">
                    <div class="input-group">
                        <label for="studentName" class="input-label">
                            <span class="label-icon">ğŸ‘¤</span>
                            <span class="text-en">Your Full Name</span>
                            <span class="text-zh" style="display: none;">æ‚¨çš„çœŸå¯¦å§“å</span>
                            <span class="required-mark">*</span>
                        </label>
                        <input type="text" id="studentName" name="studentName" required 
                               class="name-input"
                               placeholder="Enter your full name / è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å">
                    </div>
                    
                    <div class="input-group">
                        <label for="studentEmail" class="input-label">
                            <span class="label-icon">ğŸ“§</span>
                            <span class="text-en">Your Email Address</span>
                            <span class="text-zh" style="display: none;">æ‚¨çš„é›»å­éƒµä»¶åœ°å€</span>
                            <span class="required-mark">*</span>
                        </label>
                        <input type="email" id="studentEmail" name="studentEmail" required 
                               class="name-input"
                               placeholder="Enter your email / è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶">
                    </div>
                </div>



                <!-- Context Reminder -->
                <div class="context-reminder">
                    <div class="reminder-content">
                        <span class="reminder-icon">ğŸ’­</span>
                        <span class="reminder-text">
                            <span class="text-en">Think about how you behave when you're <strong>not at your best</strong> (stressed, upset, tired, etc.)</span>
                            <span class="text-zh" style="display: none;">è«‹æ€è€ƒç•¶æ‚¨<strong>ä¸åœ¨æœ€ä½³ç‹€æ…‹æ™‚</strong>ï¼ˆæ¯”å¦‚å£“åŠ›å¤§ã€å¿ƒæƒ…ä¸å¥½ã€ç–²æ†Šä¸å ªç­‰ï¼‰çš„è¡Œç‚ºè¡¨ç¾</span>
                        </span>
                    </div>
                </div>

                <!-- Questions Container -->
                <div id="questionsContainer" class="questions-container">
                    <!-- Questions will be populated by JavaScript -->
                </div>

                <!-- Submit Section -->
                <div class="submit-section">
                    <button type="submit" id="submitBtn" class="submit-button" disabled>
                        <span class="button-content">
                            <span class="button-icon">âœ¨</span>
                            <span class="button-text">
                                <span class="text-en">Reveal My Authentic Self</span>
                                <span class="text-zh" style="display: none;">æ­ç¤ºçœŸå¯¦çš„è‡ªæˆ‘</span>
                            </span>
                        </span>
                        <div class="button-shine"></div>
                    </button>
                    
                    <p class="submit-note">
                        <span class="text-en">Your personalized insights will arrive in your inbox moments after completion</span>
                        <span class="text-zh" style="display: none;">æ‚¨çš„å€‹äººåŒ–æ´å¯Ÿå°‡åœ¨å®Œæˆå¾Œç«‹å³ç™¼é€åˆ°æ‚¨çš„æ”¶ä»¶ç®±</span>
                    </p>
                </div>
            </form>
        </main>


    </div>

    <script>
        // Initialize EmailJS
        emailjs.init("I2KqoGsE81K29GmFC");

        // Language Toggle Functionality with inheritance from homepage
        function initializeLanguageToggle() {
            // Get language preference from sessionStorage (set by language selection)
            const savedLang = sessionStorage.getItem('selectedLanguage') || 'en';
            
            const langButtons = document.querySelectorAll('.lang-btn');
            const enElements = document.querySelectorAll('.text-en');
            const zhElements = document.querySelectorAll('.text-zh');
            
            // Apply saved language immediately
            if (savedLang === 'zh') {
                langButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.lang === 'zh'));
                enElements.forEach(el => el.style.display = 'none');
                zhElements.forEach(el => el.style.display = '');
                document.documentElement.lang = 'zh-TW';
                updatePlaceholders('zh');
            } else {
                langButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.lang === 'en'));
                enElements.forEach(el => el.style.display = '');
                zhElements.forEach(el => el.style.display = 'none');
                document.documentElement.lang = 'en';
                updatePlaceholders('en');
            }
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.dataset.lang;
                    
                    // Update button states
                    langButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Save language preference for current session
                    sessionStorage.setItem('selectedLanguage', lang);
                    
                    // Toggle language visibility
                    if (lang === 'en') {
                        enElements.forEach(el => el.style.display = '');
                        zhElements.forEach(el => el.style.display = 'none');
                        document.documentElement.lang = 'en';
                        updatePlaceholders('en');
                    } else {
                        enElements.forEach(el => el.style.display = 'none');
                        zhElements.forEach(el => el.style.display = '');
                        document.documentElement.lang = 'zh-TW';
                        updatePlaceholders('zh');
                    }
                    
                    // Regenerate questions in the new language
                    generateQuestions();
                });
            });
        }

        function updatePlaceholders(lang) {
            const nameInput = document.getElementById('studentName');
            const emailInput = document.getElementById('studentEmail');
            if (lang === 'en') {
                nameInput.placeholder = 'Enter your full name';
                emailInput.placeholder = 'Enter your email address';
            } else {
                nameInput.placeholder = 'è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å';
                emailInput.placeholder = 'è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶';
            }
        }

        // High-Quality Behavior Assessment Questions with Traditional Chinese Translations
        const questions = {
            en: [
                // Pleaser
                "Do you find yourself being overly flexible and accommodating to others' schedules and needs?",
                "Do you find yourself overthinking how your opinion might affect others' feelings before sharing it?",
                "Do you find yourself working extra hard to find common ground and express ideas in ways that please everyone?",
                "Do you find yourself feeling anxious if you can't create a positive and harmonious environment for everyone?",
                "Do you find yourself quickly reconsidering your views when faced with different perspectives from the group?",
                "Do you find yourself saying yes to help even when you're already overwhelmed?",
                "Do you find yourself listening more than speaking to avoid any potential conflict?",
                "Do you find yourself carefully choosing words to ensure your message won't upset anyone?",
                "Do you find yourself quickly taking responsibility to resolve misunderstandings even when they're not your fault?",
                "Do you find yourself prioritizing the group's happiness over your own needs?",
                // Worrier
                "Do you find yourself becoming overly focused on identifying potential risks and planning for every contingency?",
                "Do you find yourself getting stuck in analysis paralysis, thinking through all potential outcomes?",
                "Do you find yourself feeling anxious when you don't have a clear plan or don't know what to expect?",
                "Do you find yourself taking much longer to make decisions because you're weighing every possible pro and con?",
                "Do you find yourself obsessing over details and potential errors that others might miss?",
                "Do you find yourself insisting on extensive risk assessment even for simple decisions?",
                "Do you find yourself struggling to perform in uncertain environments where processes aren't well-defined?",
                "Do you find yourself constantly worrying about future challenges and over-preparing for them?",
                "Do you find yourself refusing to start new projects until you have an overly comprehensive plan?",
                "Do you find yourself trying to prepare for every possible situation, even unlikely ones?",
                // Prover
                "Do you find yourself desperately seeking new challenges to prove your worth?",
                "Do you find yourself feeling anxious if you're not constantly delivering results efficiently?",
                "Do you find yourself pushing yourself harder to maintain high performance as a way to feel valuable?",
                "Do you find yourself insisting on handling difficult situations alone to prove your competence?",
                "Do you find yourself immediately jumping to the next goal without celebrating achievements?",
                "Do you find yourself setting unrealistically high standards to prove you can go the extra mile?",
                "Do you find yourself becoming overly concerned about how others perceive your competence?",
                "Do you find yourself focusing obsessively on tangible results and achievements to feel worthy?",
                "Do you find yourself frantically trying to develop more skills to prove your effectiveness?",
                "Do you find yourself struggling alone with problems rather than asking for help?",
                // Critic
                "Do you find yourself setting impossibly high benchmarks for quality in your work?",
                "Do you find yourself becoming obsessed with refining and improving things until they're perfect?",
                "Do you find yourself constantly spotting problems and flaws that others miss?",
                "Do you find yourself unable to celebrate success because you're focused on what could be improved?",
                "Do you find yourself being overly harsh about errors and mistakes?",
                "Do you find yourself giving critical feedback instead of acknowledging what's working well?",
                "Do you find yourself obsessing over the smallest details that others consider unimportant?",
                "Do you find yourself becoming rigid about what is 'right' and what needs to be done?",
                "Do you find yourself constantly thinking about how to elevate performance instead of appreciating current success?",
                "Do you find yourself feeling dissatisfied and critical when things are just 'good enough'?",
                // Avoider
                "Do you find yourself procrastinating until deadlines create pressure to act?",
                "Do you find yourself hoping problems will resolve themselves rather than addressing them directly?",
                "Do you find yourself endlessly gathering information to avoid making difficult decisions?",
                "Do you find yourself focusing only on small, manageable tasks while avoiding complex situations?",
                "Do you find yourself talking about challenges without taking action to address them?",
                "Do you find yourself waiting for the 'perfect' opportunity rather than taking available actions?",
                "Do you find yourself deferring leadership to others even when you should step up?",
                "Do you find yourself avoiding necessary debates to maintain harmony?",
                "Do you find yourself blaming external factors instead of taking responsibility?",
                "Do you find yourself choosing familiar, safe paths even when they're not optimal?",
                // Martyr
                "Do you find yourself compulsively putting others' needs first even when you're depleted?",
                "Do you find yourself refusing help and insisting on handling everything yourself?",
                "Do you find yourself automatically taking on difficult tasks that others avoid?",
                "Do you find yourself believing you don't deserve rewards or personal time?",
                "Do you find yourself feeling resentful that your efforts aren't fully appreciated?",
                "Do you find yourself giving everything to projects or people without expecting anything back?",
                "Do you find yourself being generous with your time and energy even when you have nothing left to give?",
                "Do you find yourself feeling guilty if you're not taking care of everyone around you?",
                "Do you find yourself helping others to the point of personal exhaustion?",
                "Do you find yourself believing that self-sacrifice is the most noble way to live?"
            ],
            zh: [
                // Pleaser - å–æ‚…è€…
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒéåº¦éˆæ´»é…åˆä»–äººçš„æ™‚ç¨‹å’Œéœ€æ±‚ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±åœ¨åˆ†äº«æ„è¦‹å‰æœƒéåº¦æ€è€ƒå°ä»–äººæ„Ÿå—çš„å½±éŸ¿ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ ¼å¤–åŠªåŠ›å°‹æ‰¾å…±åŒé»ä¸¦ä»¥è¨å¥½æ‰€æœ‰äººçš„æ–¹å¼è¡¨é”æƒ³æ³•ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å¦‚æœç„¡æ³•ç‚ºå¤§å®¶å‰µé€ æ­£é¢å’Œè«§çš„ç’°å¢ƒå°±æœƒæ„Ÿåˆ°ç„¦æ…®ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±é¢å°åœ˜éšŠä¸åŒè§€é»æ™‚æœƒå¿«é€Ÿé‡æ–°è€ƒæ…®è‡ªå·±çš„çœ‹æ³•ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å³ä½¿å·²ç¶“ä¸å ªè² è·é‚„æ˜¯æœƒç­”æ‡‰å¹«å¿™ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒè½å¾—å¤šèªªå¾—å°‘ä»¥é¿å…ä»»ä½•æ½›åœ¨è¡çªï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒè¬¹æ…é¸è©ä»¥ç¢ºä¿ä¸æœƒæƒ¹æƒ±ä»»ä½•äººï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒå¿«é€Ÿæ‰¿æ“”è²¬ä»»åŒ–è§£èª¤æœƒï¼Œå³ä½¿ä¸æ˜¯ä½ çš„éŒ¯ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒå„ªå…ˆè€ƒæ…®åœ˜éšŠå¿«æ¨‚è€ŒçŠ§ç‰²è‡ªå·±çš„éœ€æ±‚ï¼Ÿ",
                // Worrier - æ“”æ†‚è€…
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒéåº¦å°ˆæ³¨æ–¼è­˜åˆ¥æ½›åœ¨é¢¨éšªä¸¦ç‚ºæ¯å€‹æ„å¤–æƒ…æ³åˆ¶å®šè¨ˆç•«ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒé™·å…¥åˆ†æç™±ç˜“ï¼Œæ€è€ƒæ‰€æœ‰å¯èƒ½çš„çµæœï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æ²’æœ‰æ˜ç¢ºè¨ˆç•«æˆ–ä¸çŸ¥é“æœƒç™¼ç”Ÿä»€éº¼æ™‚æœƒæ„Ÿåˆ°ç„¦æ…®ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å› ç‚ºæ¬Šè¡¡æ¯å€‹å¯èƒ½çš„åˆ©å¼Šè€ŒèŠ±è²»éé•·æ™‚é–“åšæ±ºå®šï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ²‰è¿·æ–¼ç´°ç¯€å’Œåˆ¥äººå¯èƒ½å¿½ç•¥çš„æ½›åœ¨éŒ¯èª¤ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å³ä½¿å°ç°¡å–®æ±ºç­–ä¹Ÿå …æŒé€²è¡Œå»£æ³›çš„é¢¨éšªè©•ä¼°ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±åœ¨æµç¨‹ä¸æ˜ç¢ºçš„ä¸ç¢ºå®šç’°å¢ƒä¸­é›£ä»¥è¡¨ç¾ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæŒçºŒæ“”å¿ƒæœªä¾†æŒ‘æˆ°ä¸¦éåº¦æº–å‚™ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±é™¤éæœ‰éåº¦å‘¨å…¨çš„è¨ˆç•«å¦å‰‡æ‹’çµ•é–‹å§‹æ–°å°ˆæ¡ˆï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒè©¦åœ–ç‚ºæ¯ç¨®å¯èƒ½æƒ…æ³åšæº–å‚™ï¼Œå³ä½¿æ˜¯ä¸å¤ªå¯èƒ½ç™¼ç”Ÿçš„ï¼Ÿ",
                // Prover - è­‰æ˜è€…
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ‹¼å‘½å°‹æ±‚æ–°æŒ‘æˆ°ä¾†è­‰æ˜è‡ªå·±çš„åƒ¹å€¼ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å¦‚æœæ²’æœ‰æŒçºŒé«˜æ•ˆäº¤ä»˜æˆæœå°±æœƒæ„Ÿåˆ°ç„¦æ…®ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ›´åŠ åŠªåŠ›ç¶­æŒé«˜ç¸¾æ•ˆä½œç‚ºæ„Ÿå—åƒ¹å€¼çš„æ–¹å¼ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒå …æŒç¨è‡ªè™•ç†å›°é›£æƒ…æ³ä¾†è­‰æ˜è‡ªå·±çš„èƒ½åŠ›ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç«‹åˆ»è·³åˆ°ä¸‹å€‹ç›®æ¨™è€Œä¸æ…¶ç¥æˆå°±ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒè¨­å®šä¸åˆ‡å¯¦éš›çš„é«˜æ¨™æº–ä¾†è­‰æ˜è‡ªå·±èƒ½åšåˆ°æœ€å¥½ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒéåº¦åœ¨æ„ä»–äººå¦‚ä½•çœ‹å¾…ä½ çš„èƒ½åŠ›ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ²‰è¿·æ–¼å…·é«”æˆæœå’Œæˆå°±ä¾†æ„Ÿå—è‡ªæˆ‘åƒ¹å€¼ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç˜‹ç‹‚åœ°å˜—è©¦ç™¼å±•æ›´å¤šæŠ€èƒ½ä¾†è­‰æ˜è‡ªå·±çš„æ•ˆèƒ½ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç¨è‡ªæ™æ‰è§£æ±ºå•é¡Œè€Œä¸å°‹æ±‚å¹«åŠ©ï¼Ÿ",
                // Critic - æ‰¹è©•è€…
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç‚ºå·¥ä½œè¨­å®šä¸å¯èƒ½é”åˆ°çš„é«˜å“è³ªæ¨™æº–ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ²‰è¿·æ–¼æ”¹é€²äº‹ç‰©ç›´åˆ°å®Œç¾ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒä¸æ–·ç™¼ç¾åˆ¥äººéºæ¼çš„å•é¡Œå’Œç¼ºé™·ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±ç„¡æ³•æ…¶ç¥æˆåŠŸå› ç‚ºå°ˆæ³¨æ–¼å¯ä»¥æ”¹é€²çš„åœ°æ–¹ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å°éŒ¯èª¤å’Œå¤±èª¤éæ–¼åš´å²ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒçµ¦å‡ºæ‰¹è©•åé¥‹è€Œä¸æ‰¿èªé‹ä½œè‰¯å¥½çš„éƒ¨åˆ†ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ²‰è¿·æ–¼åˆ¥äººèªç‚ºä¸é‡è¦çš„æœ€å°ç´°ç¯€ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å°ä»€éº¼æ˜¯ã€Œæ­£ç¢ºçš„ã€å’Œéœ€è¦å®Œæˆçš„äº‹è®Šå¾—åƒµåŒ–ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒä¸æ–·æ€è€ƒå¦‚ä½•æå‡ç¸¾æ•ˆè€Œä¸æ¬£è³ç•¶å‰çš„æˆåŠŸï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å°ã€Œå¤ å¥½ã€çš„äº‹ç‰©æ„Ÿåˆ°ä¸æ»¿å’Œæ‰¹è©•ï¼Ÿ",
                // Avoider - è¿´é¿è€…
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ‹–å»¶ç›´åˆ°æˆªæ­¢æ—¥æœŸç”¢ç”Ÿå£“åŠ›æ‰è¡Œå‹•ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒå¸Œæœ›å•é¡Œè‡ªè¡Œè§£æ±ºè€Œä¸ç›´æ¥è™•ç†ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç„¡æ­¢å¢ƒåœ°æ”¶é›†è³‡è¨Šä¾†é¿å…åšå›°é›£æ±ºå®šï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±åªå°ˆæ³¨æ–¼å°çš„ã€å¯ç®¡ç†çš„ä»»å‹™è€Œé¿å…è¤‡é›œæƒ…æ³ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒè«‡è«–æŒ‘æˆ°è€Œä¸æ¡å–è¡Œå‹•è§£æ±ºï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç­‰å¾…ã€Œå®Œç¾ã€æ©Ÿæœƒè€Œä¸æ¡å–ç¾æœ‰è¡Œå‹•ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å³ä½¿æ‡‰è©²æŒºèº«è€Œå‡ºä¹ŸæœƒæŠŠé ˜å°æ¬Šäº¤çµ¦åˆ¥äººï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç‚ºäº†ç¶­æŒå’Œè«§è€Œé¿å…å¿…è¦çš„è¾¯è«–ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ­¸å’æ–¼å¤–åœ¨å› ç´ è€Œä¸æ‰¿æ“”è²¬ä»»ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒé¸æ“‡ç†Ÿæ‚‰ã€å®‰å…¨çš„è·¯å¾‘å³ä½¿ä¸æ˜¯æœ€ä½³é¸æ“‡ï¼Ÿ",
                // Martyr - æ®‰é“è€…
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å³ä½¿å·²ç¶“ç²¾ç–²åŠ›ç«­é‚„æ˜¯æœƒå¼·è¿«æ€§åœ°æŠŠä»–äººéœ€æ±‚æ”¾åœ¨ç¬¬ä¸€ä½ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ‹’çµ•å¹«åŠ©ä¸¦å …æŒè‡ªå·±è™•ç†æ‰€æœ‰äº‹æƒ…ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒè‡ªå‹•æ‰¿æ“”åˆ¥äººé¿å…çš„å›°é›£ä»»å‹™ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç›¸ä¿¡è‡ªå·±ä¸å€¼å¾—ç²å¾—çå‹µæˆ–å€‹äººæ™‚é–“ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒæ€¨æ¨åŠªåŠ›æ²’æœ‰å¾—åˆ°å……åˆ†è³è­˜ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç‚ºå°ˆæ¡ˆæˆ–äººä»˜å‡ºä¸€åˆ‡è€Œä¸æœŸæœ›ä»»ä½•å›å ±ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å³ä½¿ä»€éº¼éƒ½æ²’æœ‰äº†é‚„æ˜¯æœƒæ…·æ…¨ä»˜å‡ºæ™‚é–“å’Œç²¾åŠ›ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±å¦‚æœæ²’æœ‰ç…§é¡§å‘¨åœçš„æ¯å€‹äººå°±æœƒæ„Ÿåˆ°å…§ç–šï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒå¹«åŠ©ä»–äººåˆ°å€‹äººç²¾ç–²åŠ›ç«­çš„ç¨‹åº¦ï¼Ÿ",
                "ä½ æ˜¯å¦ç™¼ç¾è‡ªå·±æœƒç›¸ä¿¡è‡ªæˆ‘çŠ§ç‰²æ˜¯æœ€é«˜å°šçš„ç”Ÿæ´»æ–¹å¼ï¼Ÿ"
            ]
        };

        // Progress Tracking
        let currentProgress = 0;
        const totalQuestions = 60;

        // Create and shuffle the question order
        const randomizedOrder = Array.from({ length: totalQuestions }, (_, i) => i);
        // Fisher-Yates shuffle algorithm
        for (let i = randomizedOrder.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [randomizedOrder[i], randomizedOrder[j]] = [randomizedOrder[j], randomizedOrder[i]];
        }

        function updateProgress() {
            const progressNumber = document.getElementById('progressNumber');
            const progressBarFill = document.getElementById('progressBarFill');
            
            const percentage = Math.round((currentProgress / totalQuestions) * 100);
            
            // Update text
            progressNumber.textContent = currentProgress;
            
            // Update progress bar
            progressBarFill.style.width = `${percentage}%`;
        }

        // Generate Questions
        function generateQuestions() {
            const container = document.getElementById('questionsContainer');
            const currentLang = document.querySelector('.lang-btn.active').dataset.lang;
            const questionSet = questions[currentLang];
            
            container.innerHTML = '';
            
            randomizedOrder.forEach((originalIndex, i) => {
                const question = questionSet[originalIndex];
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-item';
                questionDiv.dataset.originalIndex = originalIndex; // Store original index

                const labels = currentLang === 'en' ? 
                    ['Never', 'Rarely', 'Sometimes', 'Often', 'Always'] :
                    ['å¾ä¸', 'å¾ˆå°‘', 'æœ‰æ™‚', 'ç¶“å¸¸', 'ç¸½æ˜¯'];

                questionDiv.innerHTML = `
                    <div class="question-header">
                        <span class="question-number">${i + 1}</span>
                        <p class="question-text">${question}</p>
                    </div>
                    <div class="rating-container">
                        <div class="rating-options">
                            ${labels.map((label, value) => `
                                <div class="rating-option">
                                    <input type="radio" 
                                           id="q${i}_${value + 1}" 
                                           name="q${i}" 
                                           value="${value + 1}" 
                                           required
                                           data-question="${i}">
                                    <label for="q${i}_${value + 1}" class="rating-label">
                                        <span class="rating-number">${value + 1}</span>
                                        <span class="rating-text">${label}</span>
                                    </label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(questionDiv);
            });

            // Add event listeners for progress tracking
            const radioButtons = container.querySelectorAll('input[type="radio"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', () => {
                    updateProgressFromAnswers();
                });
            });
        }

        function updateProgressFromAnswers() {
            const answeredQuestions = new Set();
            
            // Count answered questions by checking if any radio button is selected for each question
            for (let i = 0; i < totalQuestions; i++) {
                const questionRadios = document.querySelectorAll(`input[name="q${i}"]`);
                const isAnswered = Array.from(questionRadios).some(radio => radio.checked);
                if (isAnswered) {
                    answeredQuestions.add(`q${i}`);
                }
            }
            
            currentProgress = answeredQuestions.size;
            updateProgress();
            
            // Enable submit button when all questions are answered
            const submitBtn = document.getElementById('submitBtn');
            const studentName = document.getElementById('studentName').value.trim();
            const studentEmail = document.getElementById('studentEmail').value.trim();
            
            if (currentProgress === totalQuestions && studentName && studentEmail) {
                submitBtn.disabled = false;
                submitBtn.classList.add('ready');
            } else {
                submitBtn.disabled = true;
                submitBtn.classList.remove('ready');
            }
        }

        // Form Submission
        document.getElementById('assessmentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const studentName = document.getElementById('studentName').value.trim();
            const studentEmail = document.getElementById('studentEmail').value.trim();
            const currentLang = document.querySelector('.lang-btn.active').dataset.lang;
            
            // Validate inputs
            if (!studentName) {
                alert(currentLang === 'en' ? 'Please enter your name.' : 'è«‹è¼¸å…¥æ‚¨çš„å§“åã€‚');
                return;
            }
            
            if (!studentEmail) {
                alert(currentLang === 'en' ? 'Please enter your email address.' : 'è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶åœ°å€ã€‚');
                return;
            }
            
            // Collect answers
            const answers = [];
            const typeScores = [0, 0, 0, 0, 0, 0]; // 6 personality types
            
            const questionItems = document.querySelectorAll('.question-item');
            questionItems.forEach((q_item, i) => {
                const selectedRadio = q_item.querySelector(`input[name="q${i}"]:checked`);
                if (selectedRadio) {
                    const answerValue = parseInt(selectedRadio.value);
                    answers.push(answerValue); // Store answer in display order

                    const originalIndex = parseInt(q_item.dataset.originalIndex);
                    const typeIndex = Math.floor(originalIndex / 10);
                    typeScores[typeIndex] += answerValue;
                }
            });
            
            // Calculate percentages
            const typePercentages = typeScores.map(score => Math.round((score / 50) * 100));
            const totalScore = answers.reduce((sum, answer) => sum + answer, 0);
            
            // Determine dominant type
            const maxScore = Math.max(...typePercentages);
            const dominantTypeIndex = typePercentages.indexOf(maxScore);
            
            const typeNames = {
                en: ['Pleaser', 'Worrier', 'Prover', 'Critic', 'Avoider', 'Martyr'],
                zh: ['å–æ‚…è€…', 'æ“”æ†‚è€…', 'è­‰æ˜è€…', 'æ‰¹è©•è€…', 'è¿´é¿è€…', 'æ®‰é“è€…']
            };
            
            // Enhanced type descriptions matching results.js structure
            const typeDescriptions = {
                0: { // Pleaser
                    fear_en: "not being liked or accepted",
                    fear_zh: "ä¸è¢«å–œæ­¡æˆ–æ¥ç´",
                    motivation_en: "seeking approval and acceptance through pleasing others",
                    motivation_zh: "é€éè¨å¥½ä»–äººä¾†ç²å¾—èªå¯å’Œæ¥ç´",
                    bestState_en: "empathetic team player with strong collaborative abilities",
                    bestState_zh: "å–„è§£äººæ„ã€åœ˜éšŠå”ä½œèƒ½åŠ›å¼·",
                    guidance_en: "practice expressing authentic thoughts and building inner confidence",
                    guidance_zh: "ç·´ç¿’è¡¨é”çœŸå¯¦æƒ³æ³•ï¼Œå»ºç«‹å…§åœ¨è‡ªä¿¡"
                },
                1: { // Worrier
                    fear_en: "uncertainty and unpredictability",
                    fear_zh: "ä¸ç¢ºå®šæ€§å’Œä¸å¯é æ¸¬æ€§",
                    motivation_en: "controlling risk through over-analysis and excessive preparation",
                    motivation_zh: "é€ééåº¦åˆ†æå’Œæº–å‚™ä¾†æ§åˆ¶é¢¨éšª",
                    bestState_en: "thoughtful planner with strong risk assessment skills",
                    bestState_zh: "è¬¹æ…æ€è€ƒã€é¢¨éšªè©•ä¼°èƒ½åŠ›å¼·",
                    guidance_en: "learn to embrace uncertainty and develop action-oriented confidence",
                    guidance_zh: "å­¸ç¿’æ¥å—ä¸ç¢ºå®šæ€§ï¼ŒåŸ¹é¤Šè¡Œå‹•å°å‘çš„è‡ªä¿¡"
                },
                2: { // Prover
                    fear_en: "being seen as incompetent or inadequate",
                    fear_zh: "è¢«è¦–ç‚ºç„¡èƒ½æˆ–ä¸è¶³",
                    motivation_en: "building self-worth through achievements and performance",
                    motivation_zh: "é€éæˆå°±å’Œè¡¨ç¾ä¾†å»ºç«‹è‡ªæˆ‘åƒ¹å€¼",
                    bestState_en: "goal-oriented achiever with strong execution abilities",
                    bestState_zh: "ç›®æ¨™å°å‘ã€åŸ·è¡ŒåŠ›å¼·çš„æˆå°±è€…",
                    guidance_en: "learn to accept help and value process over pure results",
                    guidance_zh: "å­¸ç¿’æ¥å—å¹«åŠ©ï¼Œé‡è¦–éç¨‹è€Œéåªçœ‹çµæœ"
                },
                3: { // Critic
                    fear_en: "imperfection and making mistakes",
                    fear_zh: "ä¸å®Œç¾å’ŒçŠ¯éŒ¯",
                    motivation_en: "avoiding errors and failure through high standards",
                    motivation_zh: "é€éé«˜æ¨™æº–ä¾†é¿å…éŒ¯èª¤å’Œå¤±æ•—",
                    bestState_en: "detail-oriented perfectionist with high quality standards",
                    bestState_zh: "æ³¨é‡ç´°ç¯€ã€å“è³ªæ„è­˜é«˜çš„å®Œç¾ä¸»ç¾©è€…",
                    guidance_en: "learn to accept 'good enough' standards and practice self-acceptance",
                    guidance_zh: "å­¸ç¿’æ¥å—'å¤ å¥½'çš„æ¨™æº–ï¼ŒåŸ¹é¤Šè‡ªæˆ‘æ¥ç´"
                },
                4: { // Avoider
                    fear_en: "conflict and potential failure",
                    fear_zh: "è¡çªå’Œæ½›åœ¨å¤±æ•—",
                    motivation_en: "avoiding discomfort and responsibility through withdrawal",
                    motivation_zh: "é€éé€ƒé¿ä¾†é¿å…ä¸é©å’Œè²¬ä»»",
                    bestState_en: "harmony-seeking peacemaker who avoids unnecessary conflict",
                    bestState_zh: "è¿½æ±‚å’Œè«§ã€é¿å…ä¸å¿…è¦è¡çªçš„å’Œäº‹ä½¬",
                    guidance_en: "break problems into manageable steps and build success experiences",
                    guidance_zh: "å°‡å•é¡Œåˆ†è§£ç‚ºå¯ç®¡ç†çš„æ­¥é©Ÿï¼Œå»ºç«‹æˆåŠŸç¶“é©—"
                },
                5: { // Martyr
                    fear_en: "being selfish or self-centered",
                    fear_zh: "è‡ªç§æˆ–ä»¥è‡ªæˆ‘ç‚ºä¸­å¿ƒ",
                    motivation_en: "gaining moral superiority through self-sacrifice",
                    motivation_zh: "é€éçŠ§ç‰²è‡ªå·±ä¾†ç²å¾—é“å¾·å„ªè¶Šæ„Ÿ",
                    bestState_en: "helpful and responsible with strong service orientation",
                    bestState_zh: "æ¨‚æ–¼åŠ©äººã€è²¬ä»»æ„Ÿå¼·ï¼Œå…·æœ‰å¼·çƒˆçš„æœå‹™å°å‘",
                    guidance_en: "learn to set healthy boundaries and balance giving with receiving",
                    guidance_zh: "å­¸ç¿’è¨­å®šå¥åº·ç•Œé™ï¼Œå¹³è¡¡ä»˜å‡ºèˆ‡æ¥å—"
                }
            };

            const resultCategory = typeNames[currentLang][dominantTypeIndex];
            const typeDesc = typeDescriptions[dominantTypeIndex];
            
            const resultDescription = currentLang === 'en' ? 
                `Your dominant behavioral pattern is ${resultCategory} with ${maxScore}% tendency. This pattern is driven by a core fear of ${typeDesc.fear_en}, leading to ${typeDesc.motivation_en}. At your best, you are ${typeDesc.bestState_en}. For growth, focus on: ${typeDesc.guidance_en}` :
                `æ‚¨çš„ä¸»è¦è¡Œç‚ºæ¨¡å¼æ˜¯${resultCategory}ï¼Œå‚¾å‘åº¦ç‚º${maxScore}%ã€‚æ­¤æ¨¡å¼æºæ–¼å°${typeDesc.fear_zh}çš„æ ¸å¿ƒææ‡¼ï¼Œå°è‡´${typeDesc.motivation_zh}ã€‚åœ¨æœ€ä½³ç‹€æ…‹ä¸‹ï¼Œæ‚¨æ˜¯${typeDesc.bestState_zh}ã€‚æˆé•·å»ºè­°ï¼š${typeDesc.guidance_zh}`;
            
            // Prepare email content
            const emailContent = `
                Student Name: ${studentName}
                Assessment: Personality Behavior Pattern
                Completion Date: ${new Date().toLocaleString()}
                
                Results Summary:
                Dominant Type: ${resultCategory} (${maxScore}%)
                
                Type Breakdown:
                ${typeNames.en.map((name, index) => `${name}: ${typePercentages[index]}%`).join('\n')}
                
                Description: ${resultDescription}
                
                Individual Question Responses:
                ${answers.map((answer, index) => `Question ${index + 1}: ${answer}/5`).join('\n')}
            `;
            
            try {
                // Store results and redirect (skip email for now)
                sessionStorage.setItem('assessmentResults', JSON.stringify({
                    studentName,
                    testType: 'Personality Behavior Pattern Assessment',
                    totalScore,
                    resultCategory,
                    resultDescription,
                    typePercentages,
                    answers,
                    completionDate: new Date().toLocaleString()
                }));
                
                // Try to send email but don't block on failure
                try {
                    // Create type breakdown for personality assessment
                    const typeNames = currentLang === 'en' ? 
                        ['Pleaser', 'Worrier', 'Prover', 'Critic', 'Avoider', 'Martyr'] :
                        ['å–æ‚…è€…', 'æ“”æ†‚è€…', 'è­‰æ˜è€…', 'æ‰¹è©•è€…', 'è¿´é¿è€…', 'æ®‰é“è€…'];
                    
                    const breakdownHtml = `
                        <div style="background-color: white; border-radius: 8px; padding: 16px; margin-top: 16px;">
                            <h5 style="margin: 0 0 12px 0; color: #667eea; font-size: 14px;">${currentLang === 'en' ? 'Personality Type Breakdown:' : 'äººæ ¼é¡å‹åˆ†æï¼š'}</h5>
                            ${typePercentages.map((percentage, index) => {
                                const isTop = percentage === maxScore;
                                return `<div style="display: flex; justify-content: space-between; margin-bottom: 8px; padding: 6px 12px; background-color: ${isTop ? '#f0f4ff' : '#f8f9fa'}; border-radius: 4px; ${isTop ? 'border-left: 3px solid #667eea;' : ''}">
                                    <span style="font-size: 13px; color: #555;">${typeNames[index]}${isTop ? ' â­' : ''}</span>
                                    <span style="font-weight: ${isTop ? 'bold' : 'normal'}; color: ${isTop ? '#667eea' : '#666'}; font-size: 13px;">${percentage}%</span>
                                </div>`;
                            }).join('')}
                        </div>
                    `;
                    
                    // Prepare multilingual email content
                    const emailData = {
                        student_name: studentName,
                        student_email: studentEmail || document.getElementById('studentEmail').value,
                        test_type: currentLang === 'en' ? "Personality Behavior Pattern Assessment" : "äººæ ¼è¡Œç‚ºæ¨¡å¼è©•ä¼°",
                        completion_date: new Date().toLocaleDateString(),
                        message: emailContent,
                        
                        // Header content
                        header_emoji: "ğŸ§ ",
                        header_title: currentLang === 'en' ? "Personality Results" : "äººæ ¼è©•ä¼°çµæœ",
                        
                        // Greeting and messages
                        greeting: currentLang === 'en' ? "Hello" : "æ‚¨å¥½",
                        completion_message: currentLang === 'en' ? 
                            "Thank you for completing the Personality Behavior Pattern Assessment! Your detailed personality analysis is ready." :
                            "æ„Ÿè¬æ‚¨å®Œæˆäººæ ¼è¡Œç‚ºæ¨¡å¼è©•ä¼°ï¼æ‚¨çš„è©³ç´°äººæ ¼åˆ†æå·²æº–å‚™å¥½ã€‚",
                            
                        // Results section
                        results_title: currentLang === 'en' ? "Your Personality Profile" : "æ‚¨çš„äººæ ¼æª”æ¡ˆ",
                        main_score: `${maxScore}%`,
                        score_label: currentLang === 'en' ? "Dominant Pattern Strength" : "ä¸»è¦æ¨¡å¼å¼·åº¦",
                        result_category: resultCategory,
                        result_description: resultDescription,
                        breakdown_section: breakdownHtml,
                        
                        // Insights
                        insights_title: currentLang === 'en' ? "Understanding Your Results" : "ç†è§£æ‚¨çš„çµæœ",
                        insights_text: currentLang === 'en' ? 
                            "Your personality profile reveals patterns in how you think, feel, and behave. Use these insights to understand your natural tendencies and identify opportunities for personal growth." :
                            "æ‚¨çš„äººæ ¼æª”æ¡ˆæ­ç¤ºäº†æ‚¨æ€è€ƒã€æ„Ÿå—å’Œè¡Œç‚ºçš„æ¨¡å¼ã€‚è«‹åˆ©ç”¨é€™äº›æ´å¯Ÿä¾†äº†è§£æ‚¨çš„è‡ªç„¶å‚¾å‘ä¸¦è­˜åˆ¥å€‹äººæˆé•·çš„æ©Ÿæœƒã€‚",
                            
                        // Footer content
                        detailed_title: currentLang === 'en' ? "Complete Assessment Data" : "å®Œæ•´è©•ä¼°æ•¸æ“š",
                        completion_date_label: currentLang === 'en' ? "Assessment completed on:" : "è©•ä¼°å®Œæˆæ—¥æœŸï¼š",
                        questions_text: currentLang === 'en' ? "Questions about your results?" : "å°çµæœæœ‰ç–‘å•ï¼Ÿ",
                        disclaimer_text: currentLang === 'en' ? 
                            "This personality assessment is designed for educational and self-development purposes. Results should be used as a guide for personal reflection and growth." :
                            "æ­¤è©•ä¼°ç”¨æ–¼æ•™è‚²å’Œè‡ªæˆ‘ç™¼å±•ç›®çš„ã€‚çµæœæ‡‰ä½œç‚ºå€‹äººåæ€å’Œæˆé•·çš„æŒ‡å—ã€‚",
                        footer_brand: currentLang === 'en' ? "Digitas Taiwan" : "Digitas åœ˜éšŠ",
                        footer_subtitle: currentLang === 'en' ? "Personal Evaluation" : "å€‹äººè©•ä¼°"
                    };
                    
                    // Send to user
                    await emailjs.send("service_2mndbrx", "template_z0l98oa", emailData);
                    
                    // Send to admin (always in English for admin)
                    const adminEmailData = { ...emailData };
                    adminEmailData.student_email = "felicco@gmail.com";
                    adminEmailData.test_type = "Personality Behavior Pattern Assessment";
                    adminEmailData.header_title = "Personality Results";
                    adminEmailData.greeting = "Hello";
                    adminEmailData.completion_message = `${studentName} has completed the Personality Behavior Pattern Assessment. Results summary attached.`;
                    
                    await emailjs.send("service_2mndbrx", "template_z0l98oa", adminEmailData);
                    
                    console.log('Emails sent successfully');
                } catch (emailError) {
                    console.log('Email failed but continuing to results:', emailError);
                }
                
                window.location.href = 'results.html';
                
            } catch (error) {
                console.error('Error processing assessment:', error);
                alert(currentLang === 'en' ? 
                    'There was an error processing your results. Please try again.' :
                    'è™•ç†æ‚¨çš„çµæœæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹é‡è©¦ã€‚');
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeLanguageToggle();
            generateQuestions();
            updateProgress();
            
            // Add input listeners for real-time validation
            document.getElementById('studentName').addEventListener('input', updateProgressFromAnswers);
            document.getElementById('studentEmail').addEventListener('input', updateProgressFromAnswers);
        });
    </script>

    <!-- Bottom Progress Status Bar -->
    <div id="progressIndicator" class="floating-progress floating-progress-stacked">
        <div class="progress-info">
            <span class="progress-label">
                <span class="text-en">Progress:</span>
                <span class="text-zh" style="display: none;">é€²åº¦ï¼š</span>
            </span>
            <span class="progress-count">
                <span id="progressNumber">0</span>
                <span class="progress-total">/60</span>
            </span>
        </div>
        <div class="progress-bar-container">
            <div class="progress-bar-fill" id="progressBarFill"></div>
        </div>
    </div>
</body>
</html> 