<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Journey Insights | æ‚¨çš„æ—…ç¨‹æ´å¯Ÿ</title>
    <meta name="description" content="Beautiful insights from your self-discovery journey. Celebrate your authentic self and unique way of being.">
    <link rel="stylesheet" href="../assets/css/change-assessment.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <script src="https://unpkg.com/docx@8.5.0/build/index.js"></script>
    <script src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js"></script>
</head>
<body>
    <div class="assessment-container">
        <!-- Navigation Header -->
        <nav class="nav-header">
            <a href="../index.html" class="logo">
                <span class="text-en">Explore Yourself</span>
                <span class="text-zh" style="display: none;">æ¢ç´¢è‡ªæˆ‘</span>
            </a>
            <div class="nav-meta">
                <div class="language-toggle">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="zh">ä¸­æ–‡</button>
                </div>
                <a href="../index.html" class="back-link">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-en">Back to Home</span>
                    <span class="text-zh" style="display: none;">å›åˆ°é¦–é </span>
                </a>
            </div>
        </nav>

        <!-- Results Header -->
        <header class="results-header">
            <div class="header-content">
                <div class="results-icon">âœ¨</div>
                <h1 class="results-title">
                    <span class="text-en">Assessment Results</span>
                    <span class="text-zh" style="display: none;">è©•ä¼°çµæœ</span>
                </h1>
                <p class="completion-message">
                    <span class="text-en">Assessment completed successfully. Your personalized analysis is ready.</span>
                    <span class="text-zh" style="display: none;">è©•ä¼°å·²é †åˆ©å®Œæˆï¼Œæ‚¨çš„å€‹äººåŒ–åˆ†æå ±å‘Šå·²æº–å‚™å®Œæˆã€‚</span>
                </p>
            </div>
        </header>

        <div class="results-container">
            <!-- Student Information -->
            <section class="student-info-card">
                <h2>
                    <span class="text-en">Assessment Details</span>
                    <span class="text-zh" style="display: none;">è©•ä¼°è©³æƒ…</span>
                </h2>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">
                            <span class="text-en">Name:</span>
                            <span class="text-zh" style="display: none;">å§“åï¼š</span>
                        </span>
                        <span id="studentName" class="info-value"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">
                            <span class="text-en">Assessment Type:</span>
                            <span class="text-zh" style="display: none;">è©•ä¼°é¡å‹ï¼š</span>
                        </span>
                        <span id="testType" class="info-value"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">
                            <span class="text-en">Completion Time:</span>
                            <span class="text-zh" style="display: none;">å®Œæˆæ™‚é–“ï¼š</span>
                        </span>
                        <span id="completionTime" class="info-value"></span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">
                            <span class="text-en">Total Score:</span>
                            <span class="text-zh" style="display: none;">ç¸½åˆ†ï¼š</span>
                        </span>
                        <span id="totalScore" class="info-value score-highlight"></span>
                    </div>
                </div>
            </section>

            <!-- Main Results -->
            <section class="main-results-card">
                <h2>
                    <span class="text-en">Assessment Results</span>
                    <span class="text-zh" style="display: none;">è©•ä¼°çµæœ</span>
                </h2>
                <div id="mainTendency" class="main-tendency-box">
                    <!-- Main tendency will be populated by JavaScript -->
                </div>
                <div id="interpretation" class="interpretation-box">
                    <!-- Interpretation will be populated by JavaScript -->
                </div>
            </section>

            <!-- Detailed Results for Behavior Assessment -->
            <section class="detailed-results" id="behaviorResults" style="display: none;">
                <h2>
                    <span class="text-en">ğŸŒˆ Your Communication Patterns</span>
                    <span class="text-zh" style="display: none;">ğŸŒˆ æ‚¨çš„æºé€šæ¨¡å¼</span>
                </h2>
                <div class="types-grid">
                    <div class="type-result" data-type="0">
                        <h3>
                            <span class="text-en">Pleaser</span>
                            <span class="text-zh" style="display: none;">å–æ‚…è€…</span>
                        </h3>
                        <div class="percentage-bar">
                            <div class="percentage-fill" id="percent-0"></div>
                            <span class="percentage-text" id="text-0"></span>
                        </div>
                        <p class="type-description">
                            <span class="text-en">Core fear: Not being liked | Seeks approval and acceptance through pleasing others</span>
                            <span class="text-zh" style="display: none;">æ ¸å¿ƒææ‡¼ï¼šä¸è¢«å–œæ­¡ | é€éè¨å¥½ä»–äººä¾†ç²å¾—èªå¯å’Œæ¥ç´</span>
                        </p>
                    </div>

                    <div class="type-result" data-type="1">
                        <h3>
                            <span class="text-en">Worrier</span>
                            <span class="text-zh" style="display: none;">æ“”æ†‚è€…</span>
                        </h3>
                        <div class="percentage-bar">
                            <div class="percentage-fill" id="percent-1"></div>
                            <span class="percentage-text" id="text-1"></span>
                        </div>
                        <p class="type-description">
                            <span class="text-en">Core fear: Uncertainty | Controls risk through over-analysis and preparation</span>
                            <span class="text-zh" style="display: none;">æ ¸å¿ƒææ‡¼ï¼šä¸ç¢ºå®šæ€§ | é€ééåº¦åˆ†æå’Œæº–å‚™ä¾†æ§åˆ¶é¢¨éšª</span>
                        </p>
                    </div>

                    <div class="type-result" data-type="2">
                        <h3>
                            <span class="text-en">Prover</span>
                            <span class="text-zh" style="display: none;">è­‰æ˜è€…</span>
                        </h3>
                        <div class="percentage-bar">
                            <div class="percentage-fill" id="percent-2"></div>
                            <span class="percentage-text" id="text-2"></span>
                        </div>
                        <p class="type-description">
                            <span class="text-en">Core fear: Being seen as incompetent | Builds self-worth through achievements</span>
                            <span class="text-zh" style="display: none;">æ ¸å¿ƒææ‡¼ï¼šè¢«è¦–ç‚ºç„¡èƒ½ | é€éæˆå°±å’Œè¡¨ç¾ä¾†å»ºç«‹è‡ªæˆ‘åƒ¹å€¼</span>
                        </p>
                    </div>

                    <div class="type-result" data-type="3">
                        <h3>
                            <span class="text-en">Critic</span>
                            <span class="text-zh" style="display: none;">æ‰¹è©•è€…</span>
                        </h3>
                        <div class="percentage-bar">
                            <div class="percentage-fill" id="percent-3"></div>
                            <span class="percentage-text" id="text-3"></span>
                        </div>
                        <p class="type-description">
                            <span class="text-en">Core fear: Imperfection | Avoids errors and failure through high standards</span>
                            <span class="text-zh" style="display: none;">æ ¸å¿ƒææ‡¼ï¼šä¸å®Œç¾ | é€éé«˜æ¨™æº–ä¾†é¿å…éŒ¯èª¤å’Œå¤±æ•—</span>
                        </p>
                    </div>

                    <div class="type-result" data-type="4">
                        <h3>
                            <span class="text-en">Avoider</span>
                            <span class="text-zh" style="display: none;">è¿´é¿è€…</span>
                        </h3>
                        <div class="percentage-bar">
                            <div class="percentage-fill" id="percent-4"></div>
                            <span class="percentage-text" id="text-4"></span>
                        </div>
                        <p class="type-description">
                            <span class="text-en">Core fear: Conflict and failure | Avoids discomfort and responsibility through escape</span>
                            <span class="text-zh" style="display: none;">æ ¸å¿ƒææ‡¼ï¼šè¡çªå’Œå¤±æ•— | é€éé€ƒé¿ä¾†é¿å…ä¸é©å’Œè²¬ä»»</span>
                        </p>
                    </div>

                    <div class="type-result" data-type="5">
                        <h3>
                            <span class="text-en">Martyr</span>
                            <span class="text-zh" style="display: none;">æ®‰é“è€…</span>
                        </h3>
                        <div class="percentage-bar">
                            <div class="percentage-fill" id="percent-5"></div>
                            <span class="percentage-text" id="text-5"></span>
                        </div>
                        <p class="type-description">
                            <span class="text-en">Core fear: Selfishness | Gains moral superiority through self-sacrifice</span>
                            <span class="text-zh" style="display: none;">æ ¸å¿ƒææ‡¼ï¼šè‡ªç§ | é€éçŠ§ç‰²è‡ªå·±ä¾†ç²å¾—é“å¾·å„ªè¶Šæ„Ÿ</span>
                        </p>
                    </div>
                </div>

                <!-- Color Legend -->
                <div class="legend">
                    <h3>
                        <span class="text-en">ğŸ“‹ Color Coding Legend</span>
                        <span class="text-zh" style="display: none;">ğŸ“‹ è‰²å½©ç·¨ç¢¼èªªæ˜</span>
                    </h3>
                    <div class="legend-items">
                        <div class="legend-item high">
                                                    <span class="text-en">ğŸ”´ 70%+ Strong tendency (needs focus)</span>
                        <span class="text-zh" style="display: none;">ğŸ”´ 70%+ å¼·çƒˆå‚¾å‘ (éœ€ç©æ¥µè™•ç†)</span>
                        </div>
                        <div class="legend-item obvious">
                            <span class="text-en">ğŸŸ  60-69% Obvious tendency (needs guidance)</span>
                            <span class="text-zh" style="display: none;">ğŸŸ  60-69% æ˜é¡¯å‚¾å‘ (éœ€é©ç•¶æŒ‡å°)</span>
                        </div>
                        <div class="legend-item moderate">
                            <span class="text-en">ğŸŸ¡ 50-59% Moderate tendency (continue monitoring)</span>
                            <span class="text-zh" style="display: none;">ğŸŸ¡ 50-59% ä¸­ç­‰å‚¾å‘ (æŒçºŒè§€å¯Ÿ)</span>
                        </div>
                        <div class="legend-item low">
                            <span class="text-en">ğŸŸ¢ 40-49% Lower tendency (performing well)</span>
                            <span class="text-zh" style="display: none;">ğŸŸ¢ 40-49% è¼ƒä½å‚¾å‘ (è¡¨ç¾è‰¯å¥½)</span>
                        </div>
                        <div class="legend-item very-low">
                            <span class="text-en">âšª <40% Very low tendency (balanced state)</span>
                            <span class="text-zh" style="display: none;">âšª <40% å¾ˆä½å‚¾å‘ (å¹³è¡¡ç‹€æ…‹)</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Action Buttons -->
            <section class="actions-section">
                <div class="action-buttons">
                    <button id="downloadBtn" class="action-btn download-btn">
                        <span class="btn-icon">ğŸ’–</span>
                        <span class="text-en">Save My Insights</span>
                        <span class="text-zh" style="display: none;">ä¿å­˜æˆ‘çš„æ´å¯Ÿ</span>
                    </button>
                    <button id="retakeBtn" class="action-btn retake-btn">
                        <span class="btn-icon">ğŸŒ±</span>
                        <span class="text-en">Explore Another Journey</span>
                        <span class="text-zh" style="display: none;">æ¢ç´¢å¦ä¸€å€‹æ—…ç¨‹</span>
                    </button>
                    <button id="homeBtn" class="action-btn home-btn">
                        <span class="btn-icon">ğŸ¡</span>
                        <span class="text-en">Return to Home</span>
                        <span class="text-zh" style="display: none;">å›åˆ°é¦–é </span>
                    </button>
                </div>
            </section>
        </div>

        <!-- Detailed Scores (Hidden by default) -->
        <div class="detailed-scores" id="detailedScores" style="display: none;">
            <h3>
                <span class="text-en">âœ¨ Your Journey Details</span>
                <span class="text-zh" style="display: none;">âœ¨ æ‚¨çš„æ—…ç¨‹è©³æƒ…</span>
            </h3>
            <div id="scoresTable">
                <!-- Detailed scores will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Language Toggle Functionality
        function initializeLanguageToggle() {
            const langButtons = document.querySelectorAll('.lang-btn');
            const enElements = document.querySelectorAll('.text-en');
            const zhElements = document.querySelectorAll('.text-zh');
            
            langButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.dataset.lang;
                    
                    // Update button states
                    langButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Toggle language visibility
                    if (lang === 'en') {
                        enElements.forEach(el => el.style.display = '');
                        zhElements.forEach(el => el.style.display = 'none');
                        document.documentElement.lang = 'en';
                    } else {
                        enElements.forEach(el => el.style.display = 'none');
                        zhElements.forEach(el => el.style.display = '');
                        document.documentElement.lang = 'zh-TW';
                    }
                });
            });
        }

        // Load and Display Results
        function loadResults() {
            const resultsData = sessionStorage.getItem('assessmentResults');
            
            if (!resultsData) {
                // No results found, redirect to home
                window.location.href = '../index.html';
                return;
            }
            
            const results = JSON.parse(resultsData);
            
            // Populate basic information
            document.getElementById('studentName').textContent = results.studentName;
            document.getElementById('testType').textContent = results.testType;
            document.getElementById('completionTime').textContent = results.completionDate;
            document.getElementById('totalScore').textContent = results.totalScore;
            
            // Display main result
            const mainTendency = document.getElementById('mainTendency');
            const interpretation = document.getElementById('interpretation');
            
            mainTendency.innerHTML = `
                <div class="tendency-category">${results.resultCategory}</div>
                <div class="tendency-score">${results.averageScore || results.totalScore}</div>
            `;
            
            interpretation.innerHTML = `
                <p class="interpretation-text">${results.resultDescription}</p>
            `;
            
            // Show behavior assessment specific results if it's that type
            if (results.testType && (results.testType.includes('Behavior') || results.testType.includes('Personality'))) {
                document.getElementById('behaviorResults').style.display = 'block';
                // Additional behavior-specific result processing would go here
            }
        }

        // Download Results
        function downloadResults() {
            const resultsData = sessionStorage.getItem('assessmentResults');
            if (!resultsData) return;
            
            const results = JSON.parse(resultsData);
            const currentLang = document.querySelector('.lang-btn.active').dataset.lang;
            
            const content = currentLang === 'en' ? 
                `Your Beautiful Journey Insights
                
Name: ${results.studentName}
Journey Type: ${results.testType}
Completion Date: ${results.completionDate}
Journey Score: ${results.totalScore}
Your Authentic Style: ${results.resultCategory}

Beautiful Description:
${results.resultDescription}

Your Journey Responses:
${results.answers ? results.answers.map((answer, index) => `Reflection ${index + 1}: ${answer}`).join('\n') : 'Not available'}

âœ¨ Thank you for this beautiful exploration of your authentic self!
` :
                `æ‚¨ç¾éº—çš„æ—…ç¨‹æ´å¯Ÿ
                
å§“åï¼š${results.studentName}
æ—…ç¨‹é¡å‹ï¼š${results.testType}
å®Œæˆæ—¥æœŸï¼š${results.completionDate}
æ—…ç¨‹åˆ†æ•¸ï¼š${results.totalScore}
æ‚¨çš„çœŸå¯¦é¢¨æ ¼ï¼š${results.resultCategory}

ç¾éº—çš„æè¿°ï¼š
${results.resultDescription}

æ‚¨çš„æ—…ç¨‹å›æ‡‰ï¼š
${results.answers ? results.answers.map((answer, index) => `åæ€ ${index + 1}ï¼š${answer}`).join('\n') : 'ç„¡æ³•ç²å¾—'}

âœ¨ æ„Ÿè¬æ‚¨ç¾éº—åœ°æ¢ç´¢çœŸå¯¦çš„è‡ªæˆ‘ï¼
`;
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const filename = `${results.studentName}_${results.testType.replace(/\s+/g, '_')}_Results.txt`;
            
            // Create download link
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeLanguageToggle();
            loadResults();
            
            // Action button events
            document.getElementById('downloadBtn').addEventListener('click', downloadResults);
            
            document.getElementById('retakeBtn').addEventListener('click', function() {
                const currentLang = document.querySelector('.lang-btn.active').dataset.lang;
                const confirmMsg = currentLang === 'en' ? 
                    'Would you like to explore another beautiful journey of self-discovery?' : 
                    'æ‚¨æƒ³è¦æ¢ç´¢å¦ä¸€å€‹ç¾éº—çš„è‡ªæˆ‘ç™¼ç¾ä¹‹æ—…å—ï¼Ÿ';
                
                if (confirm(confirmMsg)) {
                    sessionStorage.removeItem('assessmentResults');
                    window.location.href = '../index.html';
                }
            });
            
            document.getElementById('homeBtn').addEventListener('click', function() {
                window.location.href = '../index.html';
            });
        });
    </script>
</body>
</html> 